{
    "filters": [
        {
            "filter_name": "get_configurations",
            "params": {
                "common": {
                    "feed_name": "bhclm-new",
                    "data_partner_name": "mag-test"
                },
                "multiparam": {
                    "params": [
                        {
                            "method": "get_partner_feed_customer_info"
                        }
                    ]
                },
                "ignore_lines": {
                    "params": {
                        "header_row_count": 1,
                        "trailer_row_count": 1
                    }
                }
            }
        },
        {
            "filter_name": "split_by_position",
            "params": {
                "fields": [
                    {
                        "name": "CLM_ID_W",
                        "start": 1,
                        "end": 9
                    },
                    {
                        "name": "POLICY_ID_XYZ",
                        "start": 13,
                        "end": 19
                    },
                    {
                        "name": "RECEIVE_DT",
                        "start": 60,
                        "end": 67
                    },
                    {
                        "name": "SERV_FROM_DT",
                        "start": 77,
                        "end": 84
                    },
                    {
                        "name": "SERV_TO_DT",
                        "start": 85,
                        "end": 92
                    },
                    {
                        "name": "POS_CD_W",
                        "start": 93,
                        "end": 95
                    },
                    {
                        "name": "CLM_STATUS_CD",
                        "start": 293,
                        "end": 293
                    },
                    {
                        "name": "DISCHARGE_TYP_CD",
                        "start": 272,
                        "end": 273
                    },
                    {
                        "name": "HEALTHCARE_PROV_ORG_NETWORK_PRTP_FLG",
                        "start": 292,
                        "end": 292
                    },
                    {
                        "name": "SERV_CNT",
                        "start": 106,
                        "end": 108
                    },
                    {
                        "name": "SERV_LINE_NUM",
                        "start": 10,
                        "end": 12
                    },
                    {
                        "name": "BILLED_AMT",
                        "start": 149,
                        "end": 157
                    },
                    {
                        "name": "NOT_COV_AMT",
                        "start": 221,
                        "end": 229
                    },
                    {
                        "name": "DED_AMT",
                        "start": 176,
                        "end": 184
                    },
                    {
                        "name": "COINSURANCE_AMT",
                        "start": 185,
                        "end": 193
                    },
                    {
                        "name": "COPAY_AMT",
                        "start": 194,
                        "end": 202
                    },
                    {
                        "name": "COV_AMT",
                        "start": 158,
                        "end": 166
                    },
                    {
                        "name": "NET_PAID_AMT",
                        "start": 167,
                        "end": 175
                    },
                    {
                        "name": "WOULD_PAY_AMT",
                        "start": 230,
                        "end": 238
                    },
                    {
                        "name": "OTHER_INS_AMT",
                        "start": 255,
                        "end": 263
                    },
                    {
                        "name": "ADJUDICATION_DT",
                        "start": 68,
                        "end": 75
                    },
                    {
                        "name": "PROV_DISC_AMT",
                        "start": 203,
                        "end": 211
                    },
                    {
                        "name": "ACTIVITY_PAID_DT",
                        "start": 68,
                        "end": 75
                    },
                    {
                        "name": "BED_TYP_CD",
                        "start": 274,
                        "end": 276
                    },
                    {
                        "name": "CLM_FORM_CD_file",
                        "start": 559,
                        "end": 559
                    },
                    {
                        "name": "UNIT_DERIVED_CNT",
                        "start": 106,
                        "end": 108
                    },
                    {
                        "name": "RSN_CD_NAT_KEY_Code1",
                        "start": 239,
                        "end": 240
                    },
                    {
                        "name": "ACTIVITY_RSN_CD_Code1",
                        "start": 239,
                        "end": 240
                    },
                    {
                        "name": "RSN_CD_NAT_KEY_Code2",
                        "start": 241,
                        "end": 242
                    },
                    {
                        "name": "ACTIVITY_RSN_CD_Code2",
                        "start": 241,
                        "end": 242
                    },
                    {
                        "name": "HEALTHCARE_DIAG_VERSION_CD_Code1",
                        "start": 614,
                        "end": 615
                    },
                    {
                        "name": "HEALTHCARE_DIAG_CD_Code1",
                        "start": 109,
                        "end": 118
                    },
                    {
                        "name": "HEALTHCARE_DIAG_VERSION_CD_Code2",
                        "start": 616,
                        "end": 617
                    },
                    {
                        "name": "HEALTHCARE_DIAG_CD_Code2",
                        "start": 119,
                        "end": 128
                    },
                    {
                        "name": "HEALTHCARE_DIAG_VERSION_CD_Code3",
                        "start": 618,
                        "end": 619
                    },
                    {
                        "name": "HEALTHCARE_DIAG_CD_Code3",
                        "start": 129,
                        "end": 138
                    },
                    {
                        "name": "HEALTHCARE_DIAG_VERSION_CD_Code4",
                        "start": 620,
                        "end": 621
                    },
                    {
                        "name": "HEALTHCARE_DIAG_CD_Code4",
                        "start": 139,
                        "end": 148
                    },
                    {
                        "name": "HEALTHCARE_PROC_CD",
                        "start": 96,
                        "end": 100
                    },
                    {
                        "name": "HEALTHCARE_PROC_MOD_CD",
                        "start": 101,
                        "end": 105
                    },
                    {
                        "name": "REV_CD",
                        "start": 563,
                        "end": 566
                    },
                    {
                        "name": "NPI_ID",
                        "start": 595,
                        "end": 604
                    },
                    {
                        "name": "PROV_TAX_ID",
                        "start": 277,
                        "end": 291
                    },
                    {
                        "name": "LINE_1_ADDR",
                        "start": 442,
                        "end": 476
                    },
                    {
                        "name": "LINE_2_ADDR",
                        "start": 477,
                        "end": 511
                    },
                    {
                        "name": "CITY_NM",
                        "start": 512,
                        "end": 531
                    },
                    {
                        "name": "USPS_ZIP",
                        "start": 534,
                        "end": 543
                    },
                    {
                        "name": "USPS_ZIP_PLUS_4",
                        "start": 534,
                        "end": 543
                    },
                    {
                        "name": "US_STATE_CD",
                        "start": 532,
                        "end": 533
                    },
                    {
                        "name": "NM",
                        "start": 382,
                        "end": 411
                    },
                    {
                        "name": "FIRST_NM",
                        "start": 302,
                        "end": 316
                    },
                    {
                        "name": "LAST_NM",
                        "start": 317,
                        "end": 341
                    },
                    {
                        "name": "BIRTH_DT",
                        "start": 50,
                        "end": 57
                    },
                    {
                        "name": "GENDER_CD",
                        "start": 58,
                        "end": 58
                    },
                    {
                        "name": "ID",
                        "start": 212,
                        "end": 220
                    },
                    {
                        "name": "Ineligible_Code_1",
                        "start": 239,
                        "end": 240
                    },
                    {
                        "name": "Ineligible_Code_2",
                        "start": 241,
                        "end": 242
                    },
                    {
                        "name": "Rendering_Provider_Tax_ID",
                        "start": 277,
                        "end": 291
                    },
                    {
                        "name": "Rendering_Provider_Name",
                        "start": 382,
                        "end": 411
                    },
                    {
                        "name": "Ben_in_Out_NetWork_Indicator",
                        "start": 292,
                        "end": 292
                    },
                    {
                        "name": "Test",
                        "start": "1",
                        "end": "23"
                    }
                ]
            }
        },
        {
            "filter_name": "get_pivot_configurations",
            "params": [
                {
                    "table_name": "clm_line_item_activity_rsn",
                    "field_mapping": [
                        {
                            "RSN_CD_NAT_KEY": "$RSN_CD_NAT_KEY_Code1",
                            "ACTIVITY_RSN_CD": "$RSN_CD_NAT_KEY_Code1",
                            "LINE_NUM": "1"
                        },
                        {
                            "RSN_CD_NAT_KEY": "$RSN_CD_NAT_KEY_Code2",
                            "ACTIVITY_RSN_CD": "$RSN_CD_NAT_KEY_Code2",
                            "LINE_NUM": "1"
                        }
                    ]
                },
                {
                    "table_name": "clm_line_item_healthcare_diag",
                    "field_mapping": [
                        {
                            "HEALTHCARE_DIAG_VERSION_CD": "$HEALTHCARE_DIAG_VERSION_CD_Code1",
                            "HEALTHCARE_DIAG_CD": "$HEALTHCARE_DIAG_CD_Code1"
                        },
                        {
                            "HEALTHCARE_DIAG_VERSION_CD": "$HEALTHCARE_DIAG_VERSION_CD_Code2",
                            "HEALTHCARE_DIAG_CD": "$HEALTHCARE_DIAG_CD_Code2"
                        },
                        {
                            "HEALTHCARE_DIAG_VERSION_CD": "$HEALTHCARE_DIAG_VERSION_CD_Code3",
                            "HEALTHCARE_DIAG_CD": "$HEALTHCARE_DIAG_CD_Code3"
                        },
                        {
                            "HEALTHCARE_DIAG_VERSION_CD": "$HEALTHCARE_DIAG_VERSION_CD_Code4",
                            "HEALTHCARE_DIAG_CD": "$HEALTHCARE_DIAG_CD_Code4"
                        }
                    ]
                }
            ]
        },
        {
            "filter_name": "get_business_rule_configurations",
            "params": {
                "CLM_LINE_ITEM_ACTIVITY_1": {
                    "columns": [
                        "$CLM_ID",
                        "$SERV_LINE_NUM",
                        "$RECEIVE_DT",
                        "$CLM_STATUS_CD"
                    ]
                },
                "CLM_LINE_ITEM_REV_1": {
                    "columns": [
                        "$REV_CD",
                        "$SOURCE_LINE_NUM",
                        "$EXTRACTION_DT",
                        "$CLM_ID"
                    ]
                }
            }
        },
        {
            "filter_name": "sql_expression",
            "params": [
                {
                    "expr": "CASE WHEN (Ben_in_Out_NetWork_Indicator = 'N' OR Ben_in_Out_NetWork_Indicator = '') THEN  'TRUE' WHEN Ben_in_Out_NetWork_Indicator = 'Y' THEN 'FALSE' ELSE NULL END",
                    "targetfieldname": "HEALTHCARE_PROV_ORG_NETWORK_PRTP_FLG"
                },
                {
                    "expr": "CASE WHEN CLM_FORM_CD_file = 'P' THEN 'H' WHEN CLM_FORM_CD_file = 'I' THEN 'U' ELSE NULL END",
                    "targetfieldname": "ADJUDICATION_REMARK_CD"
                },
                {
                    "expr": "CASE WHEN (length(USPS_ZIP) > 4) THEN SUBSTRING(USPS_ZIP, 0, 5) ELSE 'N/P' END",
                    "targetfieldname": "USPS_ZIP"
                },
                {
                    "expr": "CASE WHEN (length(USPS_ZIP) = 9) THEN SUBSTRING(USPS_ZIP, 6, 4) ELSE NULL END",
                    "targetfieldname": "USPS_ZIP_PLUS_4"
                },
                {
                    "expr": "CASE WHEN (length(BILLED_AMT) != 0) THEN (CAST(BILLED_AMT AS FLOAT) / 100) ELSE NULL END",
                    "targetfieldname": "BILLED_AMT"
                },
                {
                    "expr": "CASE WHEN (length(COV_AMT) != 0) THEN (CAST(COV_AMT AS FLOAT) / 100) ELSE NULL END",
                    "targetfieldname": "COV_AMT"
                },
                {
                    "expr": "CASE WHEN HEALTHCARE_PROV_ORG_NETWORK_PRTP_FLG = 'N' and NOT_COV_AMT = 0 then BILLED_AMT - COV_AMT ELSE (CAST(NOT_COV_AMT AS FLOAT) / 100) END",
                    "targetfieldname": "NOT_COV_AMT"
                },
                {
                    "expr": "CASE WHEN (length(DED_AMT) != 0) THEN (CAST(DED_AMT AS FLOAT) / 100) ELSE NULL END",
                    "targetfieldname": "DED_AMT"
                },
                {
                    "expr": "CASE WHEN (length(COINSURANCE_AMT) != 0) THEN (CAST(COINSURANCE_AMT AS FLOAT) / 100) ELSE NULL END",
                    "targetfieldname": "COINSURANCE_AMT"
                },
                {
                    "expr": "CASE WHEN (length(COPAY_AMT) != 0) THEN (CAST(COPAY_AMT AS FLOAT) / 100) ELSE NULL END",
                    "targetfieldname": "COPAY_AMT"
                },
                {
                    "expr": "CASE WHEN (length(NET_PAID_AMT) != 0) THEN (CAST(NET_PAID_AMT AS FLOAT) / 100) ELSE NULL END",
                    "targetfieldname": "NET_PAID_AMT"
                },
                {
                    "expr": "CASE WHEN (length(WOULD_PAY_AMT) != 0) THEN (CAST(WOULD_PAY_AMT AS FLOAT) / 100) ELSE NULL END",
                    "targetfieldname": "WOULD_PAY_AMT"
                },
                {
                    "expr": "CASE WHEN (length(OTHER_INS_AMT) != 0) THEN (CAST(OTHER_INS_AMT AS FLOAT) / 100) ELSE NULL END",
                    "targetfieldname": "OTHER_INS_AMT"
                },
                {
                    "expr": "CASE WHEN (length(PROV_DISC_AMT) != 0) THEN (CAST(PROV_DISC_AMT AS FLOAT) / 100) ELSE NULL END",
                    "targetfieldname": "PROV_DISC_AMT"
                }
            ]
        },
        {
            "filter_name": "default_value",
            "params": {
                "LGL_NM": "$POLICY_ID_XYZ",
                "CLM_NAT_KEY": "$COINSURANCE_AMT"
            }
        },
        {
            "filter_name": "multiparam",
            "params": [
                {
                    "method": "get_concatenated_field",
                    "params": {
                        "target_field": "CLM_LINE_ITEM_ACTIVITY_NAT_KEY",
                        "delimiter": "~",
                        "fields": [
                            "$CLM_NAT_KEY",
                            "$SERV_LINE_NUM",
                            "$CLM_STATUS_CD"
                        ]
                    }
                },
                {
                    "method": "get_concatenated_field",
                    "params": {
                        "fields": [
                            "$CLM_NAT_KEY",
                            "$SERV_LINE_NUM"
                        ],
                        "delimiter": "~",
                        "target_field": "CLM_LINE_ITEM_NAT_KEY"
                    }
                },
                {
                    "method": "get_concatenated_field",
                    "params": {
                        "fields": [
                            "$Ineligible_Code_1",
                            "$Ineligible_Code_2"
                        ],
                        "delimiter": "~",
                        "target_field": "ADJUDICATION_REMARK_CD"
                    }
                },
                {
                    "method": "get_concatenated_field",
                    "params": {
                        "fields": [
                            "$NPI_ID",
                            "$Rendering_Provider_Name",
                            "$Rendering_Provider_Tax_ID"
                        ],
                        "delimiter": "~",
                        "target_field": "SERVICING_HEALTHCARE_PROV_ORG_NAT_KEY"
                    }
                },
                {
                    "method": "get_concatenated_field",
                    "params": {
                        "fields": [
                            "$NPI_ID",
                            "$Rendering_Provider_Name",
                            "$Rendering_Provider_Tax_ID"
                        ],
                        "delimiter": "~",
                        "target_field": "HEALTHCARE_PROV_ORG_NAT_KEY"
                    }
                },
                {
                    "method": "get_concatenated_field",
                    "params": {
                        "target_field": "ORG_NAT_KEY_123",
                        "delimiter": "~",
                        "fields": [
                            "$NPI_ID",
                            "$Rendering_Provider_Name",
                            "$Rendering_Provider_Tax_ID",
                            "$SERV_TO_DT",
                            "$RECEIVE_DT"
                        ]
                    }
                },
                {
                    "method": "get_concatenated_field",
                    "params": {
                        "fields": [
                            "$LINE_1_ADDR",
                            "$LINE_1_ADDR",
                            "$CITY_NM",
                            "$US_STATE_CD"
                        ],
                        "delimiter": "~",
                        "target_field": "LOC_NAT_KEY"
                    }
                },
                {
                    "method": "get_concatenated_field",
                    "params": {
                        "fields": [
                            "$FIRST_NM",
                            "$LAST_NM",
                            "$GENDER_CD",
                            "$BIRTH_DT"
                        ],
                        "delimiter": "~",
                        "target_field": "PRS_NAT_KEY"
                    }
                },
                {
                    "method": "get_concatenated_field",
                    "params": {
                        "target_field": "TST",
                        "delimiter": ",",
                        "fields": [
                            "$CLM_ID_W",
                            "$SERV_FROM_DT"
                        ]
                    }
                },
                {
                    "method": "get_concatenated_field",
                    "params": {
                        "target_field": "TEST",
                        "delimiter": ",",
                        "fields": [
                            "$CLM_ID_W",
                            "$RECEIVE_DT"
                        ]
                    }
                }
            ]
        }
    ]
}